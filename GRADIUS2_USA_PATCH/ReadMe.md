# GRADIUS2 USA強制認識

## IPSパッチ

[ipsパッチファイル GRA2USA.ips](GRA2USA.ips)

### パッチ対象ROMファイル
SHA-1:D63E20369F98487767810A0C57603BEF6A2A07E5

### WinIPS
WinIPSなどを使用してパッチを当てます。  
[WinIPS Homepage](http://smblabo.web.fc2.com/)

## 国コードをチェックしている箇所のコード

```
3A 2B 00        LD A,(002BH)
E6 0F           AND 0FH
                JR Z,???
```

## 強制的にUSAとして認識させるコード

パターン①かパターン②のどちらか書き換え

速度が変わらないのは②

### パターン①

```
3E 01 00        LD A,1  ;変更
E6 0F           AND 0FH
                JR Z,???
```

### パターン②

```
3A 2B 00        LD A,(002BH)
F6 01           OR 01H  ; 変更
                JR Z,???
```

## 該当コードのあるROMアドレス

- 001eca
- 002173
- 0021d4
- 0140a7
- 0140e7
- 014159
- 014196
- 0141c8
- 0141d6
- 014215
- 014230
- 0143ec
- 01441f
- 014515
- 01453f
- 014588
- 014614
- 01464e
- 015644
- 015b5c
- 015b92
- 015bb1
- 015bc0

## 解説：インターナショナルMSX

メインROMの```002BH```と```002C```Hは```IDバイト```と呼ばれ、インターナショナルMSXの為の識別情報が書かれている。

### 002BH

- bit 0-3: キャラクタジェネレータの種別
    - 0:日本
    - 1:アメリカなど
    - 2:ソビエト
- bit 4-6: 日付のフォーマット
    - 0:年／月／日
    - 1:月／日／年
    - 2:日／月／年
- bit 7: インターラプト周期(VSYNC)
    - 0:60Hz
    - 1:50Hz

### 002CH

- bit 0-3: キーボードの種別
    - 0:日本
    - 1:アメリカなど
    - 2:フランス
    - 3:イギリス
    - 4:ドイツ
    - 5:ソビエト
    - 6:スペイン
- bit 4-7: PRINT USINGなどの情報
