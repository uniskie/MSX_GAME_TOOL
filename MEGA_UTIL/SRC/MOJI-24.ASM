;***:	PUT MOJI & SET MOJI for SCREEN 2 & 4

BASFONT:	EQU	0F920H
;FILVRM:	EQU	016BH

;--------------------------------------
;WR_MES_AT:
;	POP	HL
;	CALL	WR_MES
;	INC	HL
;	JP	(HL)

;--------------------------------------
WR_MES:	LD	E,(HL)
	INC	HL
	LD	D,(HL)
	EX	DE,HL
	DI
	CALL	SETWRT
	DI
	EX	DE,HL
	INC	HL
WR_MES_:
	LD	A,(HL)
	CP	'¡'
	RET	Z
	CP	1
	JR	NZ,WR_MES_2
	INC	HL
	LD	A,(HL)
	SUB	40H
WR_MES_2:
	OUT	(VDP),A
	INC	HL
	JR	WR_MES_

;--------------------------------------
PAT_G_TB:
	DW	0
COLOR_TB:
	DW	0

;--------------------------------------
SETFONT:
	LD	A,(PAT_G_TB+1)
	AND	3FH
	OR	40H	;WRITE
	LD	C,A
	XOR	A
	DI
	CALL	VSET
	LD	HL,(BASFONT)
	LD	BC,800H
L_SFONT:
	LD	A,(HL)
	INC	HL
	LD	E,A
	SRL	E
	AND	0E0H
;	AND	0E7H
;	AND	0EFH
	OR	E
	OUT	(VDP),A
	DEC	C
	JR	NZ,L_SFONT
	DJNZ	L_SFONT

	LD	HL,(COLOR_TB)
	LD	BC,100H
	LD	A,80H
	CALL	FILVRM
	DI

	LD	A,(COLOR_TB+1)
	INC	A	; +100H
	AND	3FH
	OR	40H	;WRITE
	LD	C,A
	XOR	A
	CALL	VSET
	LD	C,0E0H
L_SFNT0:
	LD	B,4
	LD	A,0F0H
L_SFNT1:
	OUT	(VDP),A
	DJNZ	L_SFNT1
	LD	B,4
	LD	A,0E0H
L_SFNT2:
	OUT	(VDP),A
	DJNZ	L_SFNT2
	DEC	C
	JR	NZ,L_SFNT0

	LD	DE,01E0H
	LD	HL,(COLOR_TB)
	ADD	HL,DE
	LD	BC,0020H
	LD	A,80H
	CALL	FILVRM
	DI
	RET

